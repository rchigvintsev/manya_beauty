<div class="photo-album-caption row">
  <div class="col-md-12">
    <p class="text-center h3"><%= @photo_album.name %></p>
  </div>
</div>

<div class="breadcrumb-container row">
  <div class="col-md-12">
    <ol class="breadcrumb">
      <li><a href="<%= root_path %>"><%= t('home') %></a></li>
      <li><a href="<%= gallery_path %>"><%= t('gallery') %></a></li>
      <li>
        <a href="<%= gallery_path(category_id: (@photo_album.category ? @photo_album.category.id : nil)) %>">
          <%= @photo_album.category ? @photo_album.category.name : t('category.all') %>
        </a>
      </li>
      <li class="active"><%= @photo_album.name %></li>
    </ol>
  </div>
</div>

<div id="links">
  <% @photo_album.photos.each do |photo| %>
    <a href="<%= photo.photo_file_url %>" title="<%= photo.title %>"
       data-comments-href="<%= photo_comments_path(photo) %>"
       data-photo-id="<%= photo.id %>" data-gallery>
      <%= image_tag photo.photo_file_url(:thumb) %>
    </a>
  <% end %>
</div>

<div id="blueimp-gallery" class="blueimp-gallery">
  <div class="slides"></div>

  <h3 class="title"></h3>

  <a class="prev">‹</a>
  <a class="next">›</a>
  <a class="close">×</a>
  <a class="play-pause"></a>

  <ol class="indicator"></ol>

  <div class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" aria-hidden="true">&times;</button>
          <h4 class="modal-title"></h4>
        </div>

        <div class="modal-body next"></div>

        <div class="modal-footer">
          <button type="button" class="btn btn-default pull-left prev">
            <i class="glyphicon glyphicon-chevron-left"></i>
            Previous
          </button>

          <button type="button" class="btn btn-default next">
            Next
            <i class="glyphicon glyphicon-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(function () {
    $('#links').justifiedGallery({
      captions: false
    });

    $('#blueimp-gallery').on('opened', function () {
      var gallery = $(this).data('gallery');

      $('.slides > .slide').each(function (index, slide) {
        var $link = $(gallery.list[index]);
        $(slide).attr('data-photo-id', $link.attr('data-photo-id'));
        $.ajax({ url: $link.attr('data-comments-href'), type: "GET", headers: {
          Accept: '*/*;q=0.5, text/javascript, application/javascript, ' +
                  'application/ecmascript, application/x-ecmascript'
        }});
      })
    });
  });
</script>
